block drop all

table <blacklist> persist
block quick from <blacklist>

pass in on lo0
pass out on lo0

antispoof for lo0

pass out proto icmp keep state
pass out proto udp from 192.168.10.138 to any port 123 keep state
pass out on iwx0 proto udp from any to any port { 67, 68 }
pass in on iwx0 proto udp from any to any port { 67, 68 }
pass in proto icmp to 192.168.10.138 keep state
pass out proto { udp , tcp } from 192.168.10.138 to any port domain keep state
pass out proto tcp from 192.168.10.138 to any port { ssh , sftp , 6666 } keep state
pass in proto icmp to 192.168.24.5 keep state
pass out proto { udp , tcp } from 192.168.24.5 to any port domain keep state
pass out proto tcp from 192.168.24.5 to any port { ssh , sftp , 6666 } keep state
pass out proto udp from 192.168.24.5 to 192.168.24.1 port 111 keep state
pass out proto tcp from 192.168.24.5 to 192.168.24.1 port 111 keep state
pass out proto udp from 192.168.24.5 to 192.168.24.1 port 700 keep state
pass out proto tcp from 192.168.24.5 to 192.168.24.1 port 752 keep state
pass out proto udp from 192.168.24.5 to 192.168.24.1 port 651 keep state
pass out proto tcp from 192.168.24.5 to 192.168.24.1 port 714 keep state
pass out proto udp from 192.168.24.5 to 192.168.24.1 port 925 keep state
pass out proto tcp from 192.168.24.5 to 192.168.24.1 port 962 keep state
pass out proto udp from 192.168.24.5 to 192.168.24.1 port 2049 keep state
pass out proto tcp from 192.168.24.5 to 192.168.24.1 port 2049 keep state
pass out proto tcp from 192.168.24.5 to 192.168.24.1 port 873 keep state
pass out proto tcp from 192.168.24.5 to 192.168.24.7 port 3389 keep state
pass in proto tcp from 192.168.10.0/24 to 192.168.10.138 port { ssh , sftp , 6666 } keep state (max-src-conn 10 , max-src-conn-rate 5/10 , overload <blacklist> flush global)
pass in proto tcp from 192.168.24.0/24 to 192.168.24.5 port { ssh , sftp , 6666 } keep state (max-src-conn 10 , max-src-conn-rate 5/10 , overload <blacklist> flush global)
pass out proto tcp from 192.168.10.138 to any port { 80 , 443 , 8080 } keep state
pass out proto tcp from 192.168.10.138 to any port { 25 , 2525 , 587 , 143 , 993 , 465 } keep state
pass out proto tcp from 192.168.10.138 to any port { 194 , 6697 } keep state

block return-icmp in log (all, to pflog0) proto tcp from any to 192.168.10.138 port 21 max-pkt-rate 15/30
block drop in proto tcp from any to 192.168.10.138 port 21

block return-icmp in log (all, to pflog0) proto tcp from any to 192.168.10.138 port 22 max-pkt-rate 15/30
block drop in proto tcp from any to 192.168.10.138 port 22

block return-icmp in log (all, to pflog0) proto tcp from any to 192.168.10.138 port 23 max-pkt-rate 15/30
block drop in proto tcp from any to 192.168.10.138 port 23

block return-icmp in log (all, to pflog0) proto { tcp , udp } from any to 192.168.10.138 port 111 max-pkt-rate 15/30
block drop in proto { tcp , udp } from any to 192.168.10.138 port 111

block return-icmp in log (all, to pflog0) proto { tcp , udp } from any to 192.168.10.138 port { 137 , 138 , 139 } max-pkt-rate 15/30
block drop in proto { tcp , udp } from any to 192.168.10.138 port { 137 , 138 , 139 }
